# Introduction

A Task Manager API for managing tasks in a to-do list application. The API allows users to:

* Create Tasks
* Retrieve a list of all tasks
* Retrieve details of a specific task
* Update a task
* Delete a task

## Task Model

* id : unique
* title: string
* description: string
* completed: boolean
* created_at: timestamp


### Features

- Python 3.11+ support
- SQLAlchemy 2.0+ support
- Asynchoronous capabilities
- Database migrations using Alembic
- Testing suite
- Type checking using mypy
- Dockerized database
- Readily available CRUD operations
- Linting using pylint
- Formatting using black


### Installation Guide

You need following to run this project:

- Python 3.12
- Docker with Docker Compose
- Poetry


Once you have installed the above and have cloned the repository, you can follow the following steps to get the project up and running:

1. Create a virtual environment using poetry:

```bash
poetry shell
```

2. Install the dependencies:

```bash
poetry install
```
4. Copy the `.env.example` file to `.env` and update the values as per your needs.

3. Run the database and redis containers:

```bash
docker-compose up --build
```
Note: For latest Ubuntu 
```bash
docker compose up --build
```


5. Run the test (unittest and BDD Test):

```bash
make test
```

6. Run the server:

```bash
make run
```

The server should now be running on `http://localhost:8000` and the API documentation should be available at `http://localhost:8000/docs`.



### Directory Guide

The project is designed to be modular and scalable. There are 3 main directories in the project:

1. `core`: This directory contains the central part of this project. It contains most of the dependencies, database connections, configuration, middlewares etc. It also contains the base classes for the models, repositories, and controllers. The `core` directory is designed to be as minimal as possible and usually requires minimal attention.

2. `app`: This directory contains the actual application code. It contains the models, repositories, controllers, and schemas for the application. 

3. `api`: This directory contains the API layer of the application. It contains the API router, it is where you add the API endpoints.

4. `test`: This stores all the test cases unittest and the BDD test cases. Currently it uses the postgre db to execute the test cases.


### Makefile Config

This Makefile defines various commands for managing the development environment, database migrations, linting, testing, and formatting.

#### Targets:

- **install**: Install project dependencies using Poetry.
- **run**: Start the application by running `main.py` using Poetry.
- **migrate**: Apply database migrations using Alembic.
- **rollback**: Roll back the last database migration using Alembic.
- **reset-database**: Reset the database to its initial state (downgrade to base) using Alembic.
- **generate-migration**: Generate a new migration file using Alembic with an autogenerated message.
  
#### Code Quality and Formatting:
- **check**: Run `check-format` and `lint` to verify code quality and format.
- **check-format**: Check that the code is formatted correctly using `black` and `isort`.
- **lint**: Run `pylint` to check for linting errors in the `api`, `app`, and `core` directories.
- **format**: Automatically format the code using `black` and `isort`.

- **check-lockfile**: Ensure that the Poetry lock file is up-to-date with dependencies.
  
#### Testing:
- **test**: Run tests using `pytest`, clearing the cache and running with verbose output.
